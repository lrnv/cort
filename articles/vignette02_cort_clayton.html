<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2. The Copula Recursive Tree • cort</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="2. The Copula Recursive Tree">
<meta property="og:description" content="cort">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cort</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette01_ecb.html">1. Empirical Checkerboard Copula</a>
    </li>
    <li>
      <a href="../articles/vignette02_cort_clayton.html">2. The Copula Recursive Tree</a>
    </li>
    <li>
      <a href="../articles/vignette03_ecbkm.html">3. Empirical Checkerboard Copula with known margins</a>
    </li>
    <li>
      <a href="../articles/vignette04_bootstrap_varying_m.html">4. Convex mixture of m-randomized checkerboards</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lrnv/cort/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>2. The Copula Recursive Tree</h1>
            
            <h4 class="date">2020-04-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lrnv/cort/blob/master/vignettes/vignette02_cort_clayton.Rmd"><code>vignettes/vignette02_cort_clayton.Rmd</code></a></small>
      <div class="hidden name"><code>vignette02_cort_clayton.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In this vignette, we will use the Cort algorithm to fit a copula on a given simulated dataset based on clayton copula simulations. We will show how the algorithm can be used to produce a bona-fide copula, and describe some of the parameters.</p>
</div>
<div id="dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#dataset" class="anchor"></a>Dataset</h1>
<p>First, let’s create and plot the dataset we will work with. For that, we’ll use the gamma frailty model for the Clayton copula (but it’ll work for any other completely monotonous archimedean generator), as it is done in the <code>copula</code> package, see <a href="https://github.com/cran/copula/blob/6e0a5f0332776c24b2f53a81b11a8c66cc3f996d/R/claytonCopula.R#L82">there</a>. The following code is directly taken from the previous link, from the <code>copula</code> package :</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">psi</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">t</span>,<span class="no">alpha</span>) (<span class="fl">1</span> + <span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span>(<span class="no">alpha</span>)*<span class="no">t</span>) ^ (-<span class="fl">1</span>/<span class="no">alpha</span>) <span class="co"># generator</span>
<span class="no">rClayton</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">n</span>,<span class="no">dim</span>,<span class="no">alpha</span>){
  <span class="no">val</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">n</span> * <span class="no">dim</span>), <span class="kw">nrow</span> <span class="kw">=</span> <span class="no">n</span>)
  <span class="no">gam</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma</a></span>(<span class="no">n</span>, <span class="kw">shape</span> <span class="kw">=</span> <span class="fl">1</span>/<span class="no">alpha</span>, <span class="kw">rate</span> <span class="kw">=</span> <span class="fl">1</span>)
  <span class="no">gam</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">gam</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="no">dim</span>)
  <span class="fu">psi</span>(- <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">val</span>) / <span class="no">gam</span>,<span class="no">alpha</span>)
}</pre></body></html></div>
<p>For reproducibility reasons, we set the random number generator. This vignette has been compiled on a version of R &gt; 3.6, so the fix of the random number generator added in this version is used. To reproduce results from an earlier version, just use <code>sample.kind = "Rounding"</code>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">set_seed</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">seed</span>){
  <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">version</span>$<span class="no">minor</span>)<span class="kw">&lt;</span><span class="fl">6</span>){
    <span class="co"># the way of specifying the random number generation changed. </span>
    <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="no">seed</span>,<span class="kw">kind</span> <span class="kw">=</span> <span class="st">"Mersenne-Twister"</span>,<span class="kw">normal.kind</span> <span class="kw">=</span> <span class="st">"Inversion"</span>)
  } <span class="kw">else</span> {
    <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="no">seed</span>,<span class="kw">kind</span> <span class="kw">=</span> <span class="st">"Mersenne-Twister"</span>,<span class="kw">normal.kind</span> <span class="kw">=</span> <span class="st">"Inversion"</span>,<span class="kw">sample.kind</span> <span class="kw">=</span> <span class="st">"Rejection"</span>)
  }
}</pre></body></html></div>
<p>The following code simulates a dataset and then visualise it :</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu">set_seed</span>(<span class="fl">12</span>)
<span class="no">n</span> <span class="kw">=</span> <span class="fl">200</span> <span class="co"># taken small to reduce runtime of the vignette.</span>
<span class="no">d</span> <span class="kw">=</span> <span class="fl">4</span>
<span class="no">n_trees</span> <span class="kw">=</span> <span class="fl">5</span> <span class="co"># taken small to reduce runtime of the vignette.</span>
<span class="no">number_max_dim_forest</span> <span class="kw">=</span> <span class="fl">2</span> <span class="co"># taken small to reduce runtime of the vignette.</span>

<span class="no">data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw">nrow</span><span class="kw">=</span><span class="no">n</span>,<span class="kw">ncol</span><span class="kw">=</span><span class="no">d</span>)
<span class="no">data</span>[,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">3</span>)] <span class="kw">=</span> <span class="fu">rClayton</span>(<span class="kw">n</span><span class="kw">=</span><span class="no">n</span>,<span class="kw">dim</span><span class="kw">=</span><span class="no">d</span>-<span class="fl">1</span>,<span class="kw">alpha</span><span class="kw">=</span><span class="fl">7</span>)
<span class="no">data</span>[,<span class="fl">2</span>] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">n</span>)
<span class="no">data</span>[,<span class="fl">3</span>] <span class="kw">&lt;-</span> <span class="fl">1</span> - <span class="no">data</span>[,<span class="fl">3</span>]


<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span>(<span class="no">data</span>,<span class="kw">cex</span><span class="kw">=</span><span class="fl">0.6</span>)</pre></body></html></div>
<p><img src="vignette02_cort_clayton_files/figure-html/dataset-1.png" width="672"></p>
<p>We can clearly see that the second marginal is independent form the rest. In the following we will use this package to fit this dependence structure.</p>
</div>
<div id="fitting-the-cort-copula" class="section level1">
<h1 class="hasAnchor">
<a href="#fitting-the-cort-copula" class="anchor"></a>Fitting the Cort copula</h1>
<p>Now that we have a dataset, we can run the Cort algorithm on it. In the implementation proposed here, this is done via the <code><a href="../reference/Cort-Class.html">cort::Cort()</a></code> function, passing first the dataset, and then various parameters. See <code><a href="../reference/Cort-Class.html">?Cort</a></code> for a detailed list of parameters. Note that the verbosity level is quite progressive: We will here put it on 4 to see the splitting decisions that the algorithm is making.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r">(<span class="no">model</span> <span class="kw">=</span> <span class="fu"><a href="../reference/Cort-Class.html">Cort</a></span>(<span class="no">data</span>,<span class="kw">verbose_lvl</span><span class="kw">=</span><span class="fl">4</span>,<span class="kw">p_value_for_dim_red</span> <span class="kw">=</span> <span class="fl">0.75</span>))
<span class="co">#&gt; Splitting...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      1 leaves to split...</span>
<span class="co">#&gt;         Leaf with 200 points.</span>
<span class="co">#&gt;                     min   max   bp           p_value      action     reason</span>
<span class="co">#&gt;                 1   0     1     0.79304080   0.00000000   Splitted         </span>
<span class="co">#&gt;                 2   0     1     0.07337184   0.74574575   Splitted         </span>
<span class="co">#&gt;                 3   0     1     0.20898325   0.00000000   Splitted         </span>
<span class="co">#&gt;                 4   0     1     0.78899270   0.00000000   Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      10 leaves to split...</span>
<span class="co">#&gt;         Leaf with 10 points.</span>
<span class="co">#&gt;                     min          max          bp            p_value       action     reason           </span>
<span class="co">#&gt;                 1   0.00000000   0.79304080   0.179424131   0.091091091   Splitted                    </span>
<span class="co">#&gt;                 2   0.00000000   0.07337184   0.016422255   1.000000000   Removed    Independence test</span>
<span class="co">#&gt;                 3   0.20898325   1.00000000   0.762347550   0.139139139   Splitted                    </span>
<span class="co">#&gt;                 4   0.00000000   0.78899270   0.193583550   0.055055055   Splitted                    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 5 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action    reason           </span>
<span class="co">#&gt;                 1   0.00000000   0.79304080   0.74843425   0.025025025   Removed   Close to boundary</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000   0.46771144   0.815815816   Removed   Independence test</span>
<span class="co">#&gt;                 3   0.00000000   0.20898325   0.11070986   1.000000000   Removed   Independence test</span>
<span class="co">#&gt;                 4   0.00000000   0.78899270   0.74113702   0.001001001   Removed   Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action    reason           </span>
<span class="co">#&gt;                 1   0.00000000   0.79304080   0.74624009   0.059059059   Removed   Close to boundary</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000   0.74591201   1.000000000   Removed   Independence test</span>
<span class="co">#&gt;                 3   0.00000000   0.20898325   0.13032537   1.000000000   Removed   Independence test</span>
<span class="co">#&gt;                 4   0.78899270   1.00000000   0.95764982   1.000000000   Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 132 points.</span>
<span class="co">#&gt;                     min          max         bp            p_value     action     reason           </span>
<span class="co">#&gt;                 1   0.00000000   0.7930408   0.038151953   0.0000000   Splitted                    </span>
<span class="co">#&gt;                 2   0.07337184   1.0000000   0.491866533   0.9019019   Removed    Independence test</span>
<span class="co">#&gt;                 3   0.20898325   1.0000000   0.961437524   0.0000000   Splitted                    </span>
<span class="co">#&gt;                 4   0.00000000   0.7889927   0.037630898   0.0000000   Splitted                    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 10 points.</span>
<span class="co">#&gt;                     min          max         bp           p_value       action     reason</span>
<span class="co">#&gt;                 1   0.00000000   0.7930408   0.72962833   0.001001001   Splitted         </span>
<span class="co">#&gt;                 2   0.07337184   1.0000000   0.79101812   0.699699700   Splitted         </span>
<span class="co">#&gt;                 3   0.20898325   1.0000000   0.29192810   0.000000000   Splitted         </span>
<span class="co">#&gt;                 4   0.78899270   1.0000000   0.81148284   0.708708709   Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min         max          bp            p_value       action    reason           </span>
<span class="co">#&gt;                 1   0.7930408   1.00000000   0.861973466   1.000000000   Removed   Independence test</span>
<span class="co">#&gt;                 2   0.0000000   0.07337184   0.054717991   1.000000000   Removed   Independence test</span>
<span class="co">#&gt;                 3   0.0000000   0.20898325   0.098223963   1.000000000   Removed   Independence test</span>
<span class="co">#&gt;                 4   0.0000000   0.78899270   0.778773723   0.038038038   Removed   Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min         max          bp            p_value   action    reason           </span>
<span class="co">#&gt;                 1   0.7930408   1.00000000   0.850487167   1         Removed   Independence test</span>
<span class="co">#&gt;                 2   0.0000000   0.07337184   0.064606648   1         Removed   Independence test</span>
<span class="co">#&gt;                 3   0.0000000   0.20898325   0.025054111   1         Removed   Independence test</span>
<span class="co">#&gt;                 4   0.7889927   1.00000000   0.979951324   1         Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 4 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action     reason           </span>
<span class="co">#&gt;                 1   0.79304080   1.00000000   0.84166062   1.000000000   Removed    Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000   0.32339802   0.342342342   Splitted                    </span>
<span class="co">#&gt;                 3   0.00000000   0.20898325   0.15758157   0.326326326   Splitted                    </span>
<span class="co">#&gt;                 4   0.00000000   0.78899270   0.74346706   0.001001001   Removed    Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 27 points.</span>
<span class="co">#&gt;                     min          max          bp            p_value       action     reason           </span>
<span class="co">#&gt;                 1   0.79304080   1.00000000   0.910329543   0.897897898   Removed    Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000   0.338784608   0.349349349   Splitted                    </span>
<span class="co">#&gt;                 3   0.00000000   0.20898325   0.062295934   0.074074074   Splitted                    </span>
<span class="co">#&gt;                 4   0.78899270   1.00000000   0.945268572   0.054054054   Splitted                    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 5 points.</span>
<span class="co">#&gt;                     min          max         bp           p_value       action    reason           </span>
<span class="co">#&gt;                 1   0.79304080   1.0000000   0.81601693   1.000000000   Removed   Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.0000000   0.55508045   0.878878879   Removed   Independence test</span>
<span class="co">#&gt;                 3   0.20898325   1.0000000   0.24392163   0.057057057   Removed   Close to boundary</span>
<span class="co">#&gt;                 4   0.00000000   0.7889927   0.76004623   0.008008008   Removed   Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      12 leaves to split...</span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp            p_value   action    reason           </span>
<span class="co">#&gt;                 1   0.00000000   0.17942413   0.024875750     1       Removed   Independence test</span>
<span class="co">#&gt;                 2   0.00000000   0.07337184           NaN   NaN                                  </span>
<span class="co">#&gt;                 3   0.76234755   1.00000000   0.980096292     1       Removed   Independence test</span>
<span class="co">#&gt;                 4   0.00000000   0.19358355   0.024876573     1       Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 6 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action     reason           </span>
<span class="co">#&gt;                 1   0.17942413   0.79304080   0.55719742   0.69669670   Splitted                    </span>
<span class="co">#&gt;                 2   0.00000000   0.07337184          NaN          NaN                               </span>
<span class="co">#&gt;                 3   0.20898325   0.76234755   0.53324593   0.90690691   Removed    Independence test</span>
<span class="co">#&gt;                 4   0.19358355   0.78899270   0.59148401   0.46446446   Splitted                    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 5 points.</span>
<span class="co">#&gt;                     min          max           bp             p_value   action    reason           </span>
<span class="co">#&gt;                 1   0.00000000   0.038151953   0.0066146241     1       Removed   Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.000000000            NaN   NaN                                  </span>
<span class="co">#&gt;                 3   0.96143752   1.000000000   0.9937528526     1       Removed   Independence test</span>
<span class="co">#&gt;                 4   0.00000000   0.037630898   0.0062471465     1       Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 125 points.</span>
<span class="co">#&gt;                     min           max          bp            p_value   action     reason</span>
<span class="co">#&gt;                 1   0.038151953   0.79304080   0.059705199     0       Splitted         </span>
<span class="co">#&gt;                 2   0.073371840   1.00000000           NaN   NaN                        </span>
<span class="co">#&gt;                 3   0.208983252   0.96143752   0.940205770     0       Splitted         </span>
<span class="co">#&gt;                 4   0.037630898   0.78899270   0.059703164     0       Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action    reason           </span>
<span class="co">#&gt;                 1   0.00000000   0.72962833   0.67609582   0.33033033   Removed   Close to boundary</span>
<span class="co">#&gt;                 2   0.07337184   0.79101812   0.13858990   0.10810811   Removed   Close to boundary</span>
<span class="co">#&gt;                 3   0.29192810   1.00000000   0.43287058   0.41541542   Removed   Close to boundary</span>
<span class="co">#&gt;                 4   0.81148284   1.00000000   0.81689457   1.00000000   Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value   action    reason           </span>
<span class="co">#&gt;                 1   0.79304080   1.00000000          NaN   NaN                                  </span>
<span class="co">#&gt;                 2   0.32339802   1.00000000   0.62945003     1       Removed   Independence test</span>
<span class="co">#&gt;                 3   0.00000000   0.15758157   0.14922283     1       Removed   Independence test</span>
<span class="co">#&gt;                 4   0.00000000   0.78899270          NaN   NaN                                  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min           max          bp           p_value      action    reason           </span>
<span class="co">#&gt;                 1   0.793040798   1.00000000          NaN          NaN                              </span>
<span class="co">#&gt;                 2   0.073371840   0.33878461   0.33689955   0.52452452   Removed   Close to boundary</span>
<span class="co">#&gt;                 3   0.062295934   0.20898325   0.10531681   1.00000000   Removed   Independence test</span>
<span class="co">#&gt;                 4   0.788992698   0.94526857   0.83888934   1.00000000   Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 4 points.</span>
<span class="co">#&gt;                     min           max          bp           p_value       action     reason           </span>
<span class="co">#&gt;                 1   0.793040798   1.00000000          NaN           NaN                               </span>
<span class="co">#&gt;                 2   0.073371840   0.33878461   0.29162535   0.401401401   Splitted                    </span>
<span class="co">#&gt;                 3   0.062295934   0.20898325   0.12489523   0.069069069   Splitted                    </span>
<span class="co">#&gt;                 4   0.945268572   1.00000000   0.96516967   1.000000000   Removed    Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 6 points.</span>
<span class="co">#&gt;                     min          max           bp            p_value      action       reason           </span>
<span class="co">#&gt;                 1   0.79304080   1.000000000           NaN          NaN                                 </span>
<span class="co">#&gt;                 2   0.33878461   1.000000000   0.832771432   1.00000000   Removed      Independence test</span>
<span class="co">#&gt;                 3   0.00000000   0.062295934   0.052698385   1.00000000   Removed      Independence test</span>
<span class="co">#&gt;                 4   0.78899270   0.945268572   0.920373550   0.11911912   Dissmissed   No one-dim split </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max           bp            p_value   action    reason           </span>
<span class="co">#&gt;                 1   0.79304080   1.000000000           NaN   NaN                                  </span>
<span class="co">#&gt;                 2   0.33878461   1.000000000   0.870643199     1       Removed   Independence test</span>
<span class="co">#&gt;                 3   0.00000000   0.062295934   0.012254855     1       Removed   Independence test</span>
<span class="co">#&gt;                 4   0.94526857   1.000000000   0.954706026     1       Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 9 points.</span>
<span class="co">#&gt;                     min           max          bp           p_value      action       reason           </span>
<span class="co">#&gt;                 1   0.793040798   1.00000000          NaN          NaN                                 </span>
<span class="co">#&gt;                 2   0.338784608   1.00000000   0.39235299   0.46846847   Dissmissed   No one-dim split </span>
<span class="co">#&gt;                 3   0.062295934   0.20898325   0.17910352   0.84784785   Removed      Independence test</span>
<span class="co">#&gt;                 4   0.788992698   0.94526857   0.92934946   1.00000000   Removed      Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min           max          bp           p_value      action    reason           </span>
<span class="co">#&gt;                 1   0.793040798   1.00000000          NaN          NaN                              </span>
<span class="co">#&gt;                 2   0.338784608   1.00000000   0.40299445   0.65865866   Removed   Close to boundary</span>
<span class="co">#&gt;                 3   0.062295934   0.20898325   0.18668072   0.33233233   Removed   Close to boundary</span>
<span class="co">#&gt;                 4   0.945268572   1.00000000   0.95042084   1.00000000   Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      5 leaves to split...</span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value   action    reason           </span>
<span class="co">#&gt;                 1   0.55719742   0.79304080   0.55730709     1       Removed   Independence test</span>
<span class="co">#&gt;                 2   0.00000000   0.07337184          NaN   NaN                                  </span>
<span class="co">#&gt;                 3   0.20898325   0.76234755          NaN   NaN                                  </span>
<span class="co">#&gt;                 4   0.59148401   0.78899270   0.59149194     1       Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 3 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action     reason</span>
<span class="co">#&gt;                 1   0.17942413   0.55719742   0.41719338   0.30930931   Splitted         </span>
<span class="co">#&gt;                 2   0.00000000   0.07337184          NaN          NaN                    </span>
<span class="co">#&gt;                 3   0.20898325   0.76234755          NaN          NaN                    </span>
<span class="co">#&gt;                 4   0.19358355   0.59148401   0.49253019   0.35935936   Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 3 points.</span>
<span class="co">#&gt;                     min           max           bp            p_value   action    reason           </span>
<span class="co">#&gt;                 1   0.038151953   0.059705199   0.059699616     1       Removed   Independence test</span>
<span class="co">#&gt;                 2   0.073371840   1.000000000           NaN   NaN                                  </span>
<span class="co">#&gt;                 3   0.940205770   0.961437524   0.961428210     1       Removed   Independence test</span>
<span class="co">#&gt;                 4   0.037630898   0.059703164   0.057754876     1       Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 120 points.</span>
<span class="co">#&gt;                     min           max          bp           p_value   action     reason</span>
<span class="co">#&gt;                 1   0.059705199   0.79304080   0.14577559     0       Splitted         </span>
<span class="co">#&gt;                 2   0.073371840   1.00000000          NaN   NaN                        </span>
<span class="co">#&gt;                 3   0.208983252   0.94020577   0.85309008     0       Splitted         </span>
<span class="co">#&gt;                 4   0.059703164   0.78899270   0.14429348     0       Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min           max          bp            p_value       action    reason           </span>
<span class="co">#&gt;                 1   0.793040798   1.00000000           NaN           NaN                              </span>
<span class="co">#&gt;                 2   0.291625350   0.33878461   0.296769326   0.083083083   Removed   Close to boundary</span>
<span class="co">#&gt;                 3   0.062295934   0.12489523   0.069653244   1.000000000   Removed   Independence test</span>
<span class="co">#&gt;                 4   0.945268572   1.00000000           NaN           NaN                              </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      2 leaves to split...</span>
<span class="co">#&gt;         Leaf with 13 points.</span>
<span class="co">#&gt;                     min           max          bp            p_value      action       reason           </span>
<span class="co">#&gt;                 1   0.059705199   0.14577559   0.079603465   0.68468468   Dissmissed   No one-dim split </span>
<span class="co">#&gt;                 2   0.073371840   1.00000000           NaN          NaN                                 </span>
<span class="co">#&gt;                 3   0.853090078   0.94020577   0.923798083   1.00000000   Removed      Independence test</span>
<span class="co">#&gt;                 4   0.059703164   0.14429348   0.075090698   1.00000000   Removed      Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 102 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value   action     reason</span>
<span class="co">#&gt;                 1   0.14577559   0.79304080   0.27867388     0       Splitted         </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN   NaN                        </span>
<span class="co">#&gt;                 3   0.20898325   0.85309008   0.71860552     0       Splitted         </span>
<span class="co">#&gt;                 4   0.14429348   0.78899270   0.27494148     0       Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      6 leaves to split...</span>
<span class="co">#&gt;         Leaf with 18 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action     reason</span>
<span class="co">#&gt;                 1   0.14577559   0.27867388   0.23032154   0.29529530   Splitted         </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                    </span>
<span class="co">#&gt;                 3   0.71860552   0.85309008   0.76119844   0.29329329   Splitted         </span>
<span class="co">#&gt;                 4   0.14429348   0.27494148   0.23911494   0.67767768   Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action    reason           </span>
<span class="co">#&gt;                 1   0.14577559   0.27867388   0.24372982   1.000000000   Removed   Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN           NaN                              </span>
<span class="co">#&gt;                 3   0.71860552   0.85309008   0.78561023   1.000000000   Removed   Independence test</span>
<span class="co">#&gt;                 4   0.27494148   0.78899270   0.28858700   0.079079079   Removed   Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value     action    reason           </span>
<span class="co">#&gt;                 1   0.27867388   0.79304080   0.32341752   0.1041041   Removed   Close to boundary</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN         NaN                              </span>
<span class="co">#&gt;                 3   0.20898325   0.71860552   0.67056799   1.0000000   Removed   Independence test</span>
<span class="co">#&gt;                 4   0.14429348   0.27494148   0.27317643   1.0000000   Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 76 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action     reason</span>
<span class="co">#&gt;                 1   0.27867388   0.79304080   0.38446763   0.000000000   Splitted         </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN           NaN                    </span>
<span class="co">#&gt;                 3   0.20898325   0.71860552   0.61193785   0.000000000   Splitted         </span>
<span class="co">#&gt;                 4   0.27494148   0.78899270   0.37866862   0.001001001   Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action    reason           </span>
<span class="co">#&gt;                 1   0.27867388   0.79304080   0.28491421   0.068068068   Removed   Close to boundary</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN           NaN                              </span>
<span class="co">#&gt;                 3   0.71860552   0.85309008   0.73136002   0.607607608   Removed   Close to boundary</span>
<span class="co">#&gt;                 4   0.27494148   0.78899270   0.31809248   0.093093093   Removed   Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action    reason           </span>
<span class="co">#&gt;                 1   0.14577559   0.27867388   0.26178857   0.605605606   Removed   Close to boundary</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN           NaN                              </span>
<span class="co">#&gt;                 3   0.20898325   0.71860552   0.71641289   0.084084084   Removed   Close to boundary</span>
<span class="co">#&gt;                 4   0.14429348   0.27494148   0.25991916   0.589589590   Removed   Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      11 leaves to split...</span>
<span class="co">#&gt;         Leaf with 5 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action    reason           </span>
<span class="co">#&gt;                 1   0.14577559   0.23032154   0.14929000   0.14414414   Removed   Close to boundary</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                              </span>
<span class="co">#&gt;                 3   0.76119844   0.85309008   0.84919394   0.30230230   Removed   Close to boundary</span>
<span class="co">#&gt;                 4   0.14429348   0.23911494   0.18908890   0.76276276   Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action     reason           </span>
<span class="co">#&gt;                 1   0.14577559   0.23032154   0.17029167   0.31031031   Splitted                    </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                               </span>
<span class="co">#&gt;                 3   0.76119844   0.85309008   0.80272000   0.37237237   Splitted                    </span>
<span class="co">#&gt;                 4   0.23911494   0.27494148   0.24875629   1.00000000   Removed    Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value   action    reason           </span>
<span class="co">#&gt;                 1   0.23032154   0.27867388   0.26865592     1       Removed   Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN   NaN                                  </span>
<span class="co">#&gt;                 3   0.71860552   0.76119844   0.73877452     1       Removed   Independence test</span>
<span class="co">#&gt;                 4   0.14429348   0.23911494   0.22292444     1       Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 3 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action     reason           </span>
<span class="co">#&gt;                 1   0.23032154   0.27867388   0.23880626   0.085085085   Splitted                    </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN           NaN                               </span>
<span class="co">#&gt;                 3   0.76119844   0.85309008   0.81242927   1.000000000   Removed    Independence test</span>
<span class="co">#&gt;                 4   0.14429348   0.23911494   0.15921317   0.315315315   Splitted                    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 5 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action       reason           </span>
<span class="co">#&gt;                 1   0.14577559   0.23032154   0.22885274   1.00000000   Removed      Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                                 </span>
<span class="co">#&gt;                 3   0.71860552   0.76119844   0.74129241   0.68868869   Dissmissed   No one-dim split </span>
<span class="co">#&gt;                 4   0.14429348   0.23911494   0.20416796   1.00000000   Removed      Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action       reason           </span>
<span class="co">#&gt;                 1   0.27867388   0.38446763   0.32439538   0.55255255   Dissmissed   No one-dim split </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                                 </span>
<span class="co">#&gt;                 3   0.20898325   0.61193785   0.56218429   0.18718719   Removed      Close to boundary</span>
<span class="co">#&gt;                 4   0.37866862   0.78899270   0.42200612   0.16116116   Removed      Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 9 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action     reason           </span>
<span class="co">#&gt;                 1   0.27867388   0.38446763   0.34584572   0.70770771   Splitted                    </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                               </span>
<span class="co">#&gt;                 3   0.61193785   0.71860552   0.64876191   0.70970971   Splitted                    </span>
<span class="co">#&gt;                 4   0.27494148   0.37866862   0.33332581   0.76476476   Removed    Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 3 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action     reason           </span>
<span class="co">#&gt;                 1   0.27867388   0.38446763   0.35586487   0.332332332   Splitted                    </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN           NaN                               </span>
<span class="co">#&gt;                 3   0.61193785   0.71860552   0.65087692   0.312312312   Splitted                    </span>
<span class="co">#&gt;                 4   0.37866862   0.78899270   0.42288778   0.071071071   Removed    Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 4 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action     reason</span>
<span class="co">#&gt;                 1   0.38446763   0.79304080   0.43275559   0.032032032   Splitted         </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN           NaN                    </span>
<span class="co">#&gt;                 3   0.20898325   0.61193785   0.43785617   0.640640641   Splitted         </span>
<span class="co">#&gt;                 4   0.27494148   0.37866862   0.36107333   0.413413413   Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 52 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action     reason</span>
<span class="co">#&gt;                 1   0.38446763   0.79304080   0.57478706   0.000000000   Splitted         </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN           NaN                    </span>
<span class="co">#&gt;                 3   0.20898325   0.61193785   0.41041754   0.032032032   Splitted         </span>
<span class="co">#&gt;                 4   0.37866862   0.78899270   0.57216406   0.000000000   Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 4 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action       reason           </span>
<span class="co">#&gt;                 1   0.38446763   0.79304080   0.65263182   0.395395395   Dissmissed   No one-dim split </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN           NaN                                 </span>
<span class="co">#&gt;                 3   0.61193785   0.71860552   0.62361777   0.161161161   Removed      Close to boundary</span>
<span class="co">#&gt;                 4   0.37866862   0.78899270   0.39802231   0.074074074   Removed      Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      11 leaves to split...</span>
<span class="co">#&gt;         Leaf with 4 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action     reason</span>
<span class="co">#&gt;                 1   0.27867388   0.34584572   0.28856303   0.19319319   Splitted         </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                    </span>
<span class="co">#&gt;                 3   0.64876191   0.71860552   0.70468538   0.16916917   Splitted         </span>
<span class="co">#&gt;                 4   0.27494148   0.37866862          NaN          NaN                    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 3 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value   action    reason           </span>
<span class="co">#&gt;                 1   0.34584572   0.38446763   0.38446006     1       Removed   Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN   NaN                                  </span>
<span class="co">#&gt;                 3   0.61193785   0.64876191   0.61194424     1       Removed   Independence test</span>
<span class="co">#&gt;                 4   0.27494148   0.37866862          NaN   NaN                                  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action    reason           </span>
<span class="co">#&gt;                 1   0.38446763   0.43275559   0.43197933   0.41241241   Removed   Close to boundary</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                              </span>
<span class="co">#&gt;                 3   0.20898325   0.43785617   0.43725428   1.00000000   Removed   Independence test</span>
<span class="co">#&gt;                 4   0.36107333   0.37866862   0.37849255   0.38238238   Removed   Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 3 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action     reason</span>
<span class="co">#&gt;                 1   0.38446763   0.57478706   0.53255997   0.60360360   Splitted         </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                    </span>
<span class="co">#&gt;                 3   0.20898325   0.41041754   0.36830693   0.53553554   Splitted         </span>
<span class="co">#&gt;                 4   0.57216406   0.78899270   0.62189160   0.54454454   Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 12 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action     reason</span>
<span class="co">#&gt;                 1   0.38446763   0.57478706   0.45392283   0.53253253   Splitted         </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                    </span>
<span class="co">#&gt;                 3   0.41041754   0.61193785   0.54725995   0.12612613   Splitted         </span>
<span class="co">#&gt;                 4   0.37866862   0.57216406   0.50213758   0.22222222   Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 5 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action    reason           </span>
<span class="co">#&gt;                 1   0.38446763   0.57478706   0.41812081   0.86186186   Removed   Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                              </span>
<span class="co">#&gt;                 3   0.41041754   0.61193785   0.45271834   0.92692693   Removed   Independence test</span>
<span class="co">#&gt;                 4   0.57216406   0.78899270   0.59260790   0.89889890   Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 5 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action    reason           </span>
<span class="co">#&gt;                 1   0.57478706   0.79304080   0.78000435   0.45145145   Removed   Close to boundary</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                              </span>
<span class="co">#&gt;                 3   0.20898325   0.41041754   0.40369854   0.58058058   Removed   Close to boundary</span>
<span class="co">#&gt;                 4   0.37866862   0.57216406   0.38806681   0.60960961   Removed   Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 14 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action       reason           </span>
<span class="co">#&gt;                 1   0.57478706   0.79304080   0.66906962   0.59759760   Dissmissed   No one-dim split </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                                 </span>
<span class="co">#&gt;                 3   0.20898325   0.41041754   0.32337966   0.93893894   Removed      Independence test</span>
<span class="co">#&gt;                 4   0.57216406   0.78899270   0.67360653   1.00000000   Removed      Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 5 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action       reason           </span>
<span class="co">#&gt;                 1   0.57478706   0.79304080   0.59204184   1.00000000   Removed      Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                                 </span>
<span class="co">#&gt;                 3   0.41041754   0.61193785   0.47921955   0.02002002   Dissmissed   No one-dim split </span>
<span class="co">#&gt;                 4   0.37866862   0.57216406   0.56043564   0.77777778   Removed      Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action    reason           </span>
<span class="co">#&gt;                 1   0.57478706   0.79304080   0.74397174   1.00000000   Removed   Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                              </span>
<span class="co">#&gt;                 3   0.41041754   0.61193785   0.44283793   0.19019019   Removed   Close to boundary</span>
<span class="co">#&gt;                 4   0.57216406   0.78899270   0.63184191   1.00000000   Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 6 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action     reason</span>
<span class="co">#&gt;                 1   0.38446763   0.57478706   0.55302081   0.035035035   Splitted         </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN           NaN                    </span>
<span class="co">#&gt;                 3   0.20898325   0.41041754   0.26173461   0.289289289   Splitted         </span>
<span class="co">#&gt;                 4   0.37866862   0.57216406   0.54726122   0.050050050   Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      6 leaves to split...</span>
<span class="co">#&gt;         Leaf with 3 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action     reason</span>
<span class="co">#&gt;                 1   0.28856303   0.34584572   0.30011869   0.24324324   Splitted         </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                    </span>
<span class="co">#&gt;                 3   0.64876191   0.70468538   0.69153730   0.25325325   Splitted         </span>
<span class="co">#&gt;                 4   0.27494148   0.37866862          NaN          NaN                    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value   action    reason           </span>
<span class="co">#&gt;                 1   0.38446763   0.53255997   0.50413751     1       Removed   Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN   NaN                                  </span>
<span class="co">#&gt;                 3   0.20898325   0.36830693   0.28414694     1       Removed   Independence test</span>
<span class="co">#&gt;                 4   0.62189160   0.78899270   0.65174462     1       Removed   Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 4 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action       reason           </span>
<span class="co">#&gt;                 1   0.38446763   0.45392283   0.42784790   0.83583584   Removed      Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                                 </span>
<span class="co">#&gt;                 3   0.54725995   0.61193785   0.59644145   0.16916917   Dissmissed   No one-dim split </span>
<span class="co">#&gt;                 4   0.37866862   0.50213758   0.47065791   0.84984985   Removed      Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action    reason           </span>
<span class="co">#&gt;                 1   0.38446763   0.45392283   0.39801573   1.00000000   Removed   Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                              </span>
<span class="co">#&gt;                 3   0.54725995   0.61193785   0.55229947   1.00000000   Removed   Independence test</span>
<span class="co">#&gt;                 4   0.50213758   0.57216406   0.56709854   0.16516517   Removed   Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 3 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action       reason           </span>
<span class="co">#&gt;                 1   0.45392283   0.57478706   0.50248944   1.00000000   Removed      Independence test</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                                 </span>
<span class="co">#&gt;                 3   0.41041754   0.54725995   0.46481152   0.46046046   Dissmissed   No one-dim split </span>
<span class="co">#&gt;                 4   0.50213758   0.57216406   0.53910068   0.83783784   Removed      Independence test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 4 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value       action     reason           </span>
<span class="co">#&gt;                 1   0.38446763   0.55302081   0.50746038   0.421421421   Splitted                    </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN           NaN                               </span>
<span class="co">#&gt;                 3   0.26173461   0.41041754   0.34764725   1.000000000   Removed    Independence test</span>
<span class="co">#&gt;                 4   0.37866862   0.54726122   0.50577221   0.063063063   Splitted                    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      3 leaves to split...</span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action       reason           </span>
<span class="co">#&gt;                 1   0.30011869   0.34584572   0.30845777   0.53153153   Removed      Close to boundary</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                                 </span>
<span class="co">#&gt;                 3   0.64876191   0.69153730   0.66071158   0.57057057   Dissmissed   No one-dim split </span>
<span class="co">#&gt;                 4   0.27494148   0.37866862          NaN          NaN                                 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action    reason           </span>
<span class="co">#&gt;                 1   0.50746038   0.55302081   0.50749992   0.74074074   Removed   Close to boundary</span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                              </span>
<span class="co">#&gt;                 3   0.26173461   0.41041754          NaN          NaN                              </span>
<span class="co">#&gt;                 4   0.50577221   0.54726122   0.54722296   0.68868869   Removed   Close to boundary</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Leaf with 2 points.</span>
<span class="co">#&gt;                     min          max          bp           p_value      action     reason</span>
<span class="co">#&gt;                 1   0.38446763   0.50746038   0.48003072   0.48348348   Splitted         </span>
<span class="co">#&gt;                 2   0.07337184   1.00000000          NaN          NaN                    </span>
<span class="co">#&gt;                 3   0.26173461   0.41041754          NaN          NaN                    </span>
<span class="co">#&gt;                 4   0.37866862   0.50577221   0.47760793   0.51951952   Splitted         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      0 leaves to split...</span>
<span class="co">#&gt; Enforcing constraints...</span>
<span class="co">#&gt; -----------------------------------------------------------------</span>
<span class="co">#&gt;            OSQP v0.6.0  -  Operator Splitting QP Solver</span>
<span class="co">#&gt;               (c) Bartolomeo Stellato,  Goran Banjac</span>
<span class="co">#&gt;         University of Oxford  -  Stanford University 2019</span>
<span class="co">#&gt; -----------------------------------------------------------------</span>
<span class="co">#&gt; problem:  variables n = 158, constraints m = 301</span>
<span class="co">#&gt;           nnz(P) + nnz(A) = 14310</span>
<span class="co">#&gt; settings: linear system solver = qdldl,</span>
<span class="co">#&gt;           eps_abs = 1.0e-06, eps_rel = 1.0e-06,</span>
<span class="co">#&gt;           eps_prim_inf = 1.0e-06, eps_dual_inf = 1.0e-06,</span>
<span class="co">#&gt;           rho = 1.00e-01 (adaptive),</span>
<span class="co">#&gt;           sigma = 1.00e-06, alpha = 1.60, max_iter = 100000</span>
<span class="co">#&gt;           check_termination: on (interval 25),</span>
<span class="co">#&gt;           scaling: on, scaled_termination: off</span>
<span class="co">#&gt;           warm start: on, polish: on, time_limit: off</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; iter   objective    pri res    dua res    rho        time</span>
<span class="co">#&gt;    1  -3.4405e+01   2.29e-02   5.80e+03   1.00e-01   3.77e-03s</span>
<span class="co">#&gt;  200  -3.1490e+01   1.22e-05   3.45e-03   1.11e+00   1.52e-02s</span>
<span class="co">#&gt;  400  -3.1488e+01   5.36e-06   2.70e-03   1.11e+00   2.54e-02s</span>
<span class="co">#&gt;  600  -3.1486e+01   4.18e-06   2.09e-03   1.11e+00   3.56e-02s</span>
<span class="co">#&gt;  800  -3.1484e+01   3.26e-06   1.63e-03   1.11e+00   4.60e-02s</span>
<span class="co">#&gt; 1000  -3.1483e+01   2.54e-06   1.27e-03   1.11e+00   5.62e-02s</span>
<span class="co">#&gt; 1200  -3.1481e+01   1.98e-06   9.92e-04   1.11e+00   6.66e-02s</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; status:               solved</span>
<span class="co">#&gt; solution polish:      unsuccessful</span>
<span class="co">#&gt; number of iterations: 1200</span>
<span class="co">#&gt; optimal objective:    -31.4813</span>
<span class="co">#&gt; run time:             7.66e-02s</span>
<span class="co">#&gt; optimal rho estimate: 6.43e-01</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Done !</span>
<span class="co">#&gt; Cort copula model: 200x4-dataset and 158 leaves.</span></pre></body></html></div>
<p>Looking at the top of the output, we see that the first thing the algorithm did was removing the second dimension due to the independence test. Now that the copula is fitted, we have access to numerous of it’s methods. Two plotting functions are exported with this model, the <code>pairs</code> function is implemented at a very low level in the class hierarchy and hence is working with almost all copulas of this package, but the <code>plot</code> function is only implemented for Cort.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span>(<span class="no">model</span>)</pre></body></html></div>
<div class="figure">
<img src="vignette02_cort_clayton_files/figure-html/unnamed-chunk-1-1.png" alt="Pairs-plot of original data (in black, bottom-left corner) versus a simulation from the model (in red, top-right corner)" width="672"><p class="caption">
Pairs-plot of original data (in black, bottom-left corner) versus a simulation from the model (in red, top-right corner)
</p>
</div>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">model</span>)</pre></body></html></div>
<div class="figure">
<img src="vignette02_cort_clayton_files/figure-html/unnamed-chunk-2-1.png" alt="Gray boxes representing 2-d projections of the fitted density. In red, the imputed data points." width="672"><p class="caption">
Gray boxes representing 2-d projections of the fitted density. In red, the imputed data points.
</p>
</div>
<p>We see that there are some noise with point were there should not be. A bagged version of the model is accessible via the <code>CortForest</code> class, and might be able to correct these problems.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Oskar Laverny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
